<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>AppSheet 活用記録（新データ）</title>
  <style>
    body {
      font-family: "Noto Sans JP", sans-serif;
      margin: 2em;
      background: #fafafa;
    }
    h1 {
      text-align: center;
      margin-bottom: 1em;
    }
    .card {
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      margin: 1.5em auto;
      max-width: 600px;
      padding: 1em 2em;
    }
    .card img {
      max-width: 100%;
      border-radius: 8px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>AppSheet 活用記録（227行目以降）</h1>
  <div id="records">データを読み込み中...</div>

  <script>
    // スプレッドシートのJSON URL
    const sheetUrl = "https://spreadsheets.google.com/feeds/list/1zTZcCo36XxvVzOxVeJj4TW30j0SBArUwnQxYbh04sMU/0/public/values?alt=json";

    fetch(sheetUrl)
      .then(res => res.json())
      .then(data => {
        const entries = data.feed.entry;
        let html = "";

        // 227行目以降だけを表示（0始まりなので index >= 226）
        entries.slice(226).forEach(row => {
          const date = row.gsx$作成日?.$t || "";
          const recipe = row.gsx$料理名活用方法?.$t || "";
          const product = row.gsx$使用したシネコ生産物?.$t || "";
          const source = row.gsx$出典?.$t || "";
          const imageUrl = row.gsx$appsheet?.$t || ""; // M列(Appsheet)

          html += `
            <div class="card">
              <h3>${recipe || "（無題）"}</h3>
              <p><b>作成日:</b> ${date}</p>
              <p><b>使用したシネコ生産物:</b> ${product}</p>
              <p><b>出典:</b> ${source}</p>
              ${imageUrl ? `<img src="${imageUrl}" alt="${recipe}">` : ""}
            </div>
          `;
        });

        document.getElementById("records").innerHTML = html || "表示できるデータがありません。";
      })
      .catch(err => {
        document.getElementById("records").innerHTML = "データを読み込めませんでした。";
        console.error(err);
      });
  </script>
</body>
</html>
