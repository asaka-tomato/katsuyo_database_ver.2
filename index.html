<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>テスト表示 - JSON 行確認</title>
</head>
<body>
  <h1>スプレッドシート行確認</h1>
  <pre id="output">読み込み中...</pre>

  <script>
    const sheetUrl =
      "https://docs.google.com/spreadsheets/d/1zTZcCo36XxvVzOxVeJj4TW30j0SBArUwnQxYbh04sMU/gviz/tq?sheet=全体活用記録&tqx=out:json";

    async function loadData() {
      try {
        const res = await fetch(sheetUrl);
        const text = await res.text();
        const json = JSON.parse(text.substr(47).slice(0, -2));
        const rows = json.table.rows;

        let log = `取得行数: ${rows.length}\n\n`;
        rows.forEach((r, index) => {
          const recipe = r.c[1]?.v || "";
          const image = r.c[12]?.v || "";
          if (recipe || image) {
            log += `index:${index} | 料理名:${recipe} | 画像:${image}\n`;
          }
        });

        document.getElementById("output").textContent = log;
      } catch (e) {
        document.getElementById("output").textContent = "読み込み失敗: " + e;
      }
    }

    loadData();
  </script>
</body>
</html>
