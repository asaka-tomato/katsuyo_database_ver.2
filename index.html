function copyAppSheetImages() {
  // === è¨­å®šéƒ¨åˆ† ===
  const sourceFolderId = "1j8VOQJzHn-U3NfF1NjX_agWatcMuoS7o"; // AppSheetç”»åƒãƒ•ã‚©ãƒ«ãƒ€
  const targetFolderId = "1fTGEHh40QJz2i65Ym3IjGvMxj4xddsXQ"; // â† SharedImages ãƒ•ã‚©ãƒ«ãƒ€ID
  const sheetName = "å…¨ä½“æ´»ç”¨è¨˜éŒ²";
  const photoColumnName = "å†™çœŸ1";     // ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ãŒå…¥ã£ã¦ã„ã‚‹åˆ—
  const urlColumnName = "å†™çœŸã®ãƒªãƒ³ã‚¯"; // å…¬é–‹URLã‚’æ›¸ãè¾¼ã‚€åˆ—

  // === å‡¦ç†éƒ¨åˆ† ===
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sheet = ss.getSheetByName(sheetName);
  const data = sheet.getDataRange().getValues();

  const headerRow = 2; // 2è¡Œç›®ãŒè¦‹å‡ºã—è¡Œ
  const header = data[headerRow];
  const photoColIndex = header.indexOf(photoColumnName);
  const urlColIndex = header.indexOf(urlColumnName);

  if (photoColIndex === -1 || urlColIndex === -1) {
    Logger.log("âŒ åˆ—åãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚");
    return;
  }

  const sourceFolder = DriveApp.getFolderById(sourceFolderId);
  const targetFolder = DriveApp.getFolderById(targetFolderId);
  const sourceFiles = sourceFolder.getFiles();
  const copiedFiles = {};

  while (sourceFiles.hasNext()) {
    const file = sourceFiles.next();
    copiedFiles[file.getName()] = file;
  }

  for (let i = headerRow + 1; i < data.length; i++) {
    const photoPath = data[i][photoColIndex];
    if (!photoPath || typeof photoPath !== "string") continue;

    const photoName = photoPath.split("/").pop();
    if (!photoName) continue;

    const existingUrl = data[i][urlColIndex];
    if (existingUrl && existingUrl.toString().startsWith("https://drive.google.com/uc")) continue;

    const file = copiedFiles[photoName];
    if (file) {
      // åŒåãƒ•ã‚¡ã‚¤ãƒ«ãŒã™ã§ã«ã‚ã‚Œã°ãã‚Œã‚’ä½¿ç”¨ã€ãªã‘ã‚Œã°ã‚³ãƒ”ãƒ¼
      const existing = targetFolder.getFilesByName(photoName);
      let targetFile;
      if (existing.hasNext()) {
        targetFile = existing.next();
      } else {
        targetFile = file.makeCopy(photoName, targetFolder);
      }

      // âœ… å…¬é–‹è¨­å®šã‚’ã€Œãƒªãƒ³ã‚¯ã‚’çŸ¥ã£ã¦ã„ã‚‹å…¨å“¡ã€ã«å¤‰æ›´
      targetFile.setSharing(DriveApp.Access.ANYONE_WITH_LINK, DriveApp.Permission.VIEW);

      // âœ… ç”»åƒURLã‚’ä½œæˆ
      const url = "https://drive.google.com/uc?export=view&id=" + targetFile.getId();
      sheet.getRange(i + 1, urlColIndex + 1).setValue(url);
      Logger.log("âœ… å…¬é–‹URLä½œæˆ: " + photoName + " â†’ " + url);
    } else {
      Logger.log("âš ï¸ ãƒ•ã‚¡ã‚¤ãƒ«æœªæ¤œå‡º: " + photoName);
    }
  }

  Logger.log("ğŸ‰ ã™ã¹ã¦ã®å‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸï¼");
}
